<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<META NAME="generator" CONTENT="http://txt2tags.sf.net">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<LINK REL="stylesheet" TYPE="text/css" HREF="http://shopexts.googlecode.com/files/vul.css">
<TITLE>ECshop XSS脚本跨站漏洞</TITLE>
</HEAD>
<BODY>

<DIV CLASS="header" ID="header">
<H1>ECshop XSS脚本跨站漏洞</H1>
<H2>last modify 2011-07-20 15:27:19 Wednesday</H2>
</DIV>

<DIV CLASS="body" ID="body">
<H4>添加时间</H4>
<P>
2011-03-23
</P>
<H4>系统编号</H4>
<H4>影响版本</H4>
<P>
ECShop  &lt;= 2.7.2
</P>
<H4>漏洞危害</H4>
<P>
成功利用该漏洞的攻击者可以在网站中插入恶意代码
</P>
<H4>漏洞原理</H4>
<P>
在includes/cls_template.php 287行
return preg_replace("/{([^\}\{\n]*)}/e", "\$this-&gt;select('\\1');", $source);
模板中没过滤php标签，在编译模板的时候执行了模板中的php代码。
</P>
<H4>检测方法</H4>
<P>
无
</P>
<H4>解决方案</H4>
<P>
ecshop团队发布安全补丁，补丁下载地址
</P>
<P>
<A HREF="http://bbs.ecshop.com/thread-148571-1-3.html">http://bbs.ecshop.com/thread-148571-1-3.html</A>
</P>
<H4>信息来源</H4>
<P>
<A HREF="http://www.wooyun.org/bug.php?action=view&amp;id=1636">http://www.wooyun.org/bug.php?action=view&amp;id=1636</A>
</P>
</DIV>

<!-- html code generated by txt2tags 2.5 (http://txt2tags.sf.net) -->
<!-- cmdline: txt2tags -\-target=html -\-infile=t2t/11032301.t2t -\-outfile=htdocs/11032301.html -->
</BODY></HTML>
