<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<META NAME="generator" CONTENT="http://txt2tags.sf.net">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<LINK REL="stylesheet" TYPE="text/css" HREF="http://shopexts.googlecode.com/files/vul.css">
<TITLE>ECshop XSS脚本跨站漏洞</TITLE>
</HEAD>
<BODY>

<DIV CLASS="header" ID="header">
<H1>ECshop XSS脚本跨站漏洞</H1>
<H2>last modify 2011-03-15 16:26:18 Tuesday</H2>
</DIV>

<DIV CLASS="body" ID="body">
<H4>添加时间</H4>
<P>
2011-03-15
</P>
<H4>系统编号</H4>
<H4>影响版本</H4>
<P>
ECShop  &lt;= 2.7.2
</P>
<H4>漏洞危害</H4>
<P>
成功利用该漏洞的攻击者可以在网站中插入恶意代码
</P>
<H4>漏洞原理</H4>
<P>
search.php页面,第108行
$_REQUEST['keywords']   = !empty($_REQUEST['keywords'])   ? trim($_REQUEST['keywords'])     : '';
</P>
<P>
没有在最初始时过滤htmlspecialchars($_REQUEST['keywords']),只是在后面使用中过滤，造成漏洞。
</P>
<P>
pick_out.php页面，第135行
 $picks[] = array('name'=&gt;'&lt;strong&gt;'.$row['attr_name'].':&lt;/strong&gt;&lt;br /&gt;'. urldecode($_GET['attr'][$row['attr_id']]), 'url'=&gt;'pick_out.php?cat_id='.$cat_id.search_url($attr_picks, $row['attr_id']));
</P>
<P>
将urldecode($_GET['attr'][$row['attr_id']])没有进行过滤严格，造成漏洞。
</P>
<P>
message.php页面，第53行
$filter_attr_str = isset($_REQUEST['filter_attr']) ? trim($_REQUEST['filter_attr']) : '0';
</P>
<P>
filter_attr_str过滤不严，造成漏洞。
</P>
<P>
brand.php、category.php、exchange.php页面对$display变量过滤不严造成漏洞。
</P>
<P>
Includes/init.php功能对$_SERVER['PHP_SELF']变量过滤不严造成漏洞。
</P>
<P>
article_cat.php页面，第50行
$page  = !empty($_REQUEST['page']) ? intval($_REQUEST['page']) : 1;
过滤不严格造成sql注入漏洞。
</P>
<H4>检测方法</H4>
<P>
无
</P>
<H4>解决方案</H4>
<P>
ecshop团队发布安全补丁，补丁下载地址
</P>
<P>
<A HREF="http://bbs.ecshop.com/thread-148082-1-2.html">http://bbs.ecshop.com/thread-148082-1-2.html</A>
</P>
<H4>信息来源</H4>
<P>
 <A HREF="http://www.fengblog.org/">http://www.fengblog.org/</A>
</P>
</DIV>

<!-- html code generated by txt2tags 2.5 (http://txt2tags.sf.net) -->
<!-- cmdline: txt2tags -\-target=html -\-infile=t2t/11031501.t2t -\-outfile=htdocs/11031501.html -->
</BODY></HTML>
