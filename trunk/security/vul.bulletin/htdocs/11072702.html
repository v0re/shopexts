<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<META NAME="generator" CONTENT="http://txt2tags.sf.net">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<LINK REL="stylesheet" TYPE="text/css" HREF="http://shopexts.googlecode.com/files/vul.css">
<TITLE>易开店及shopex485后台模板编辑中文件删除漏洞</TITLE>
</HEAD>
<BODY>

<DIV CLASS="header" ID="header">
<H1>易开店及shopex485后台模板编辑中文件删除漏洞</H1>
<H2>last modify 2011-07-27 16:33:34 Wednesday</H2>
</DIV>

<DIV CLASS="body" ID="body">
<H4>添加时间</H4>
<P>
2011-07-27
</P>
<H4>系统编号</H4>
<P>
SEC-11072702
</P>
<H4>影响版本</H4>
<P>
ShopEx485 &gt;= 38669
易开店 1.0.0
</P>
<H4>漏洞危害</H4>
<P>
可以修改后台“模板管理”中的“模板文件管理”的url地址中的theme参数来删除网站目录下的配置文件以及一些重要文件。
</P>
<H4>漏洞原理</H4>
<P>
主要是原先我们系统没有对传入的参数进行过滤，默认将传入的参数作为文件目录的一部分，这样直接导致有些恶意用户如果知道这些传参的意义，
就可以通过这个地方来删除网站目录下的配置文件以及一些重要文件。
</P>
<H4>检测方法</H4>
<P>
无
</P>
<H4>解决方案</H4>
<P>
编写里一个参数预过滤函数，在“模板文件管理”的url地址传入的参数进行预处理，将带“..”的去掉。并在构造函数里调用这个函数。
</P>
<H4>信息来源</H4>
<P>
客户反馈
</P>
</DIV>

<!-- html code generated by txt2tags 2.5 (http://txt2tags.sf.net) -->
<!-- cmdline: txt2tags -\-target=html -\-infile=t2t/11072702.t2t -\-outfile=htdocs/11072702.html -->
</BODY></HTML>
