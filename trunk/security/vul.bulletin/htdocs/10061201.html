<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<META NAME="generator" CONTENT="http://txt2tags.sf.net">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<LINK REL="stylesheet" TYPE="text/css" HREF="http://shopexts.googlecode.com/files/vul.css">
<TITLE>crontab日志注释符使用当</TITLE>
</HEAD>
<BODY>

<DIV CLASS="header" ID="header">
<H1>crontab日志注释符使用当</H1>
<H2>last modify 2010-11-18 16:53:30 Thursday</H2>
</DIV>

<DIV CLASS="body" ID="body">
<H4>添加时间</H4>
<P>
2010-07-26
</P>
<H4>系统编号</H4>
<P>
SEC10072601
</P>
<H4>影响版本</H4>
<P>
ShopEx485 &gt;= 38669
</P>
<H4>漏洞危害</H4>
<P>
生成webshell
</P>
<H4>漏洞原理</H4>
<P>
\core\include_v5\crontab.php
</P>
<PRE>
file_put_contents( $this-&gt;logFile, "#\n" );
</PRE>
<P></P>
<P>
生成文件时加多了一个#号在前面，导致某些版本的php(尤其是linux)会把#后面的判定为注释
</P>
<H4>检测方法</H4>
<P>
直接提交：
</P>
<PRE>
http://127.0.0.1/shopex/?cron=1&amp;action=1&amp;p=1
</PRE>
<P>
一句话在：
</P>
<PRE>
http://127.0.0.1/shopex/home/logs/access.log.php
</PRE>
<H4>解决方案</H4>
<PRE>
http://bbs.shopex.cn/read.php?tid-160218.html
</PRE>
<P>
修复CRONTAB.PHP的安全问题 485 SVN版本号 48329 484 SVN版本号48330
</P>
<H4>信息来源</H4>
<P>
<A HREF="http://www.haik8.com/haikejishu/2010-06-11/soft_794.html">http://www.haik8.com/haikejishu/2010-06-11/soft_794.html</A>
</P>
</DIV>

<!-- html code generated by txt2tags 2.5 (http://txt2tags.sf.net) -->
<!-- cmdline: txt2tags -\-target=html -\-infile=t2t/10061201.t2t -\-outfile=htdocs/10061201.html -->
</BODY></HTML>
